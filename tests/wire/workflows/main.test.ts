// This file was auto-generated by Fern from our API Definition.

import * as phenoml from "../../../src/api/index";
import { phenomlClient } from "../../../src/Client";
import { mockServerPool } from "../../mock-server/MockServerPool";

describe("Workflows", () => {
    test("list (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new phenomlClient({ token: "test", environment: server.baseUrl });

        const rawResponseBody = {
            success: true,
            message: "Workflows retrieved successfully",
            workflows: [
                {
                    id: "550e8400-e29b-41d4-a716-446655440001",
                    name: "Patient Data Mapping Workflow",
                    workflow_instructions: "Given diagnosis data, find the patient and create condition record",
                    sample_data: {
                        diagnosis_code: "I10",
                        diagnosis_date: "2025-01-01",
                        patient_first_name: "Clay",
                        patient_last_name: "Rippin",
                    },
                    config: { fhir_provider_ids: ["550e8400-e29b-41d4-a716-446655440000"], dynamic_generation: false },
                    created_at: "2024-01-15T10:30:00Z",
                    updated_at: "2024-01-15T15:45:00Z",
                },
            ],
            workflow_details: [
                {
                    id: "550e8400-e29b-41d4-a716-446655440001",
                    name: "Patient Data Mapping Workflow",
                    workflow_instructions: "Given diagnosis data, find the patient and create condition record",
                    sample_data: {
                        diagnosis_code: "I10",
                        diagnosis_date: "2025-01-01",
                        patient_first_name: "Clay",
                        patient_last_name: "Rippin",
                    },
                    config: { fhir_provider_ids: ["550e8400-e29b-41d4-a716-446655440000"], dynamic_generation: false },
                    created_at: "2024-01-15T10:30:00Z",
                    updated_at: "2024-01-15T15:45:00Z",
                },
            ],
        };
        server.mockEndpoint().get("/workflows").respondWith().statusCode(200).jsonBody(rawResponseBody).build();

        const response = await client.workflows.list({
            verbose: true,
        });
        expect(response).toEqual({
            success: true,
            message: "Workflows retrieved successfully",
            workflows: [
                {
                    id: "550e8400-e29b-41d4-a716-446655440001",
                    name: "Patient Data Mapping Workflow",
                    workflow_instructions: "Given diagnosis data, find the patient and create condition record",
                    sample_data: {
                        diagnosis_code: "I10",
                        diagnosis_date: "2025-01-01",
                        patient_first_name: "Clay",
                        patient_last_name: "Rippin",
                    },
                    config: {
                        fhir_provider_ids: ["550e8400-e29b-41d4-a716-446655440000"],
                        dynamic_generation: false,
                    },
                    created_at: "2024-01-15T10:30:00Z",
                    updated_at: "2024-01-15T15:45:00Z",
                },
            ],
            workflow_details: [
                {
                    id: "550e8400-e29b-41d4-a716-446655440001",
                    name: "Patient Data Mapping Workflow",
                    workflow_instructions: "Given diagnosis data, find the patient and create condition record",
                    sample_data: {
                        diagnosis_code: "I10",
                        diagnosis_date: "2025-01-01",
                        patient_first_name: "Clay",
                        patient_last_name: "Rippin",
                    },
                    config: {
                        fhir_provider_ids: ["550e8400-e29b-41d4-a716-446655440000"],
                        dynamic_generation: false,
                    },
                    created_at: "2024-01-15T10:30:00Z",
                    updated_at: "2024-01-15T15:45:00Z",
                },
            ],
        });
    });

    test("list (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new phenomlClient({ token: "test", environment: server.baseUrl });

        const rawResponseBody = { key: "value" };
        server.mockEndpoint().get("/workflows").respondWith().statusCode(401).jsonBody(rawResponseBody).build();

        await expect(async () => {
            return await client.workflows.list();
        }).rejects.toThrow(phenoml.workflows.UnauthorizedError);
    });

    test("list (3)", async () => {
        const server = mockServerPool.createServer();
        const client = new phenomlClient({ token: "test", environment: server.baseUrl });

        const rawResponseBody = { key: "value" };
        server.mockEndpoint().get("/workflows").respondWith().statusCode(403).jsonBody(rawResponseBody).build();

        await expect(async () => {
            return await client.workflows.list();
        }).rejects.toThrow(phenoml.workflows.ForbiddenError);
    });

    test("list (4)", async () => {
        const server = mockServerPool.createServer();
        const client = new phenomlClient({ token: "test", environment: server.baseUrl });

        const rawResponseBody = { key: "value" };
        server.mockEndpoint().get("/workflows").respondWith().statusCode(500).jsonBody(rawResponseBody).build();

        await expect(async () => {
            return await client.workflows.list();
        }).rejects.toThrow(phenoml.workflows.InternalServerError);
    });

    test("create (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new phenomlClient({ token: "test", environment: server.baseUrl });
        const rawRequestBody = {
            name: "Patient Data Mapping Workflow",
            workflow_instructions: "Given diagnosis data, find the patient and create condition record",
            sample_data: { patient_last_name: "Rippin", patient_first_name: "Clay", diagnosis_code: "I10" },
            fhir_provider_id: "550e8400-e29b-41d4-a716-446655440000",
        };
        const rawResponseBody = {
            success: true,
            message: "Workflow created successfully",
            workflow_id: "550e8400-e29b-41d4-a716-446655440001",
            workflow: {
                id: "550e8400-e29b-41d4-a716-446655440001",
                name: "Patient Data Mapping Workflow",
                workflow_instructions: "Given diagnosis data, find the patient and create condition record",
                sample_data: {
                    diagnosis_code: "I10",
                    diagnosis_date: "2025-01-01",
                    patient_first_name: "Clay",
                    patient_last_name: "Rippin",
                },
                config: { fhir_provider_ids: ["550e8400-e29b-41d4-a716-446655440000"], dynamic_generation: false },
                graph: {
                    steps: [
                        {
                            id: "step_1_id",
                            name: "Find Patient",
                            description: "Search for an existing patient by first name and last name",
                            provider_id: "550e8400-e29b-41d4-a716-446655440000",
                        },
                    ],
                },
                created_at: "2024-01-15T10:30:00Z",
                updated_at: "2024-01-15T15:45:00Z",
            },
            workflow_details: {
                id: "550e8400-e29b-41d4-a716-446655440001",
                name: "Patient Data Mapping Workflow",
                workflow_instructions: "Given diagnosis data, find the patient and create condition record",
                sample_data: {
                    diagnosis_code: "I10",
                    diagnosis_date: "2025-01-01",
                    patient_first_name: "Clay",
                    patient_last_name: "Rippin",
                },
                config: { fhir_provider_ids: ["550e8400-e29b-41d4-a716-446655440000"], dynamic_generation: false },
                graph: {
                    steps: [
                        {
                            id: "1",
                            name: "Create Patient Resource",
                            description: "Create a FHIR Patient resource from input data",
                            provider_id: "550e8400-e29b-41d4-a716-446655440000",
                            dependencies: ["dependencies"],
                            dynamic_generation: false,
                        },
                    ],
                },
                created_at: "2024-01-15T10:30:00Z",
                updated_at: "2024-01-15T15:45:00Z",
            },
        };
        server
            .mockEndpoint()
            .post("/workflows")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.workflows.create({
            verbose: true,
            name: "Patient Data Mapping Workflow",
            workflow_instructions: "Given diagnosis data, find the patient and create condition record",
            sample_data: {
                patient_last_name: "Rippin",
                patient_first_name: "Clay",
                diagnosis_code: "I10",
            },
            fhir_provider_id: "550e8400-e29b-41d4-a716-446655440000",
        });
        expect(response).toEqual({
            success: true,
            message: "Workflow created successfully",
            workflow_id: "550e8400-e29b-41d4-a716-446655440001",
            workflow: {
                id: "550e8400-e29b-41d4-a716-446655440001",
                name: "Patient Data Mapping Workflow",
                workflow_instructions: "Given diagnosis data, find the patient and create condition record",
                sample_data: {
                    diagnosis_code: "I10",
                    diagnosis_date: "2025-01-01",
                    patient_first_name: "Clay",
                    patient_last_name: "Rippin",
                },
                config: {
                    fhir_provider_ids: ["550e8400-e29b-41d4-a716-446655440000"],
                    dynamic_generation: false,
                },
                graph: {
                    steps: [
                        {
                            id: "step_1_id",
                            name: "Find Patient",
                            description: "Search for an existing patient by first name and last name",
                            provider_id: "550e8400-e29b-41d4-a716-446655440000",
                        },
                    ],
                },
                created_at: "2024-01-15T10:30:00Z",
                updated_at: "2024-01-15T15:45:00Z",
            },
            workflow_details: {
                id: "550e8400-e29b-41d4-a716-446655440001",
                name: "Patient Data Mapping Workflow",
                workflow_instructions: "Given diagnosis data, find the patient and create condition record",
                sample_data: {
                    diagnosis_code: "I10",
                    diagnosis_date: "2025-01-01",
                    patient_first_name: "Clay",
                    patient_last_name: "Rippin",
                },
                config: {
                    fhir_provider_ids: ["550e8400-e29b-41d4-a716-446655440000"],
                    dynamic_generation: false,
                },
                graph: {
                    steps: [
                        {
                            id: "1",
                            name: "Create Patient Resource",
                            description: "Create a FHIR Patient resource from input data",
                            provider_id: "550e8400-e29b-41d4-a716-446655440000",
                            dependencies: ["dependencies"],
                            dynamic_generation: false,
                        },
                    ],
                },
                created_at: "2024-01-15T10:30:00Z",
                updated_at: "2024-01-15T15:45:00Z",
            },
        });
    });

    test("create (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new phenomlClient({ token: "test", environment: server.baseUrl });
        const rawRequestBody = {
            name: "name",
            workflow_instructions: "workflow_instructions",
            sample_data: { sample_data: { key: "value" } },
            fhir_provider_id: "fhir_provider_id",
        };
        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .post("/workflows")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(400)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.workflows.create({
                name: "name",
                workflow_instructions: "workflow_instructions",
                sample_data: {
                    sample_data: {
                        key: "value",
                    },
                },
                fhir_provider_id: "fhir_provider_id",
            });
        }).rejects.toThrow(phenoml.workflows.BadRequestError);
    });

    test("create (3)", async () => {
        const server = mockServerPool.createServer();
        const client = new phenomlClient({ token: "test", environment: server.baseUrl });
        const rawRequestBody = {
            name: "name",
            workflow_instructions: "workflow_instructions",
            sample_data: { sample_data: { key: "value" } },
            fhir_provider_id: "fhir_provider_id",
        };
        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .post("/workflows")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(401)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.workflows.create({
                name: "name",
                workflow_instructions: "workflow_instructions",
                sample_data: {
                    sample_data: {
                        key: "value",
                    },
                },
                fhir_provider_id: "fhir_provider_id",
            });
        }).rejects.toThrow(phenoml.workflows.UnauthorizedError);
    });

    test("create (4)", async () => {
        const server = mockServerPool.createServer();
        const client = new phenomlClient({ token: "test", environment: server.baseUrl });
        const rawRequestBody = {
            name: "name",
            workflow_instructions: "workflow_instructions",
            sample_data: { sample_data: { key: "value" } },
            fhir_provider_id: "fhir_provider_id",
        };
        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .post("/workflows")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(403)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.workflows.create({
                name: "name",
                workflow_instructions: "workflow_instructions",
                sample_data: {
                    sample_data: {
                        key: "value",
                    },
                },
                fhir_provider_id: "fhir_provider_id",
            });
        }).rejects.toThrow(phenoml.workflows.ForbiddenError);
    });

    test("create (5)", async () => {
        const server = mockServerPool.createServer();
        const client = new phenomlClient({ token: "test", environment: server.baseUrl });
        const rawRequestBody = {
            name: "name",
            workflow_instructions: "workflow_instructions",
            sample_data: { sample_data: { key: "value" } },
            fhir_provider_id: "fhir_provider_id",
        };
        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .post("/workflows")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(500)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.workflows.create({
                name: "name",
                workflow_instructions: "workflow_instructions",
                sample_data: {
                    sample_data: {
                        key: "value",
                    },
                },
                fhir_provider_id: "fhir_provider_id",
            });
        }).rejects.toThrow(phenoml.workflows.InternalServerError);
    });

    test("get (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new phenomlClient({ token: "test", environment: server.baseUrl });

        const rawResponseBody = {
            success: true,
            workflow: {
                id: "550e8400-e29b-41d4-a716-446655440001",
                name: "Patient Data Mapping Workflow",
                workflow_instructions: "Given diagnosis data, find the patient and create condition record",
                sample_data: {
                    diagnosis_code: "I10",
                    diagnosis_date: "2025-01-01",
                    patient_first_name: "Clay",
                    patient_last_name: "Rippin",
                },
                config: { fhir_provider_ids: ["550e8400-e29b-41d4-a716-446655440000"], dynamic_generation: false },
                graph: {
                    steps: [
                        {
                            id: "step_1_id",
                            name: "Find Patient",
                            description: "Search for an existing patient by first name and last name",
                            provider_id: "550e8400-e29b-41d4-a716-446655440000",
                        },
                    ],
                },
                created_at: "2024-01-15T10:30:00Z",
                updated_at: "2024-01-15T15:45:00Z",
            },
            workflow_details: {
                id: "550e8400-e29b-41d4-a716-446655440001",
                name: "Patient Data Mapping Workflow",
                workflow_instructions: "Given diagnosis data, find the patient and create condition record",
                sample_data: {
                    diagnosis_code: "I10",
                    diagnosis_date: "2025-01-01",
                    patient_first_name: "Clay",
                    patient_last_name: "Rippin",
                },
                config: { fhir_provider_ids: ["550e8400-e29b-41d4-a716-446655440000"], dynamic_generation: false },
                graph: {
                    steps: [
                        {
                            id: "1",
                            name: "Create Patient Resource",
                            description: "Create a FHIR Patient resource from input data",
                            provider_id: "550e8400-e29b-41d4-a716-446655440000",
                            dependencies: ["dependencies"],
                            dynamic_generation: false,
                        },
                    ],
                },
                created_at: "2024-01-15T10:30:00Z",
                updated_at: "2024-01-15T15:45:00Z",
            },
        };
        server.mockEndpoint().get("/workflows/id").respondWith().statusCode(200).jsonBody(rawResponseBody).build();

        const response = await client.workflows.get("id", {
            verbose: true,
        });
        expect(response).toEqual({
            success: true,
            workflow: {
                id: "550e8400-e29b-41d4-a716-446655440001",
                name: "Patient Data Mapping Workflow",
                workflow_instructions: "Given diagnosis data, find the patient and create condition record",
                sample_data: {
                    diagnosis_code: "I10",
                    diagnosis_date: "2025-01-01",
                    patient_first_name: "Clay",
                    patient_last_name: "Rippin",
                },
                config: {
                    fhir_provider_ids: ["550e8400-e29b-41d4-a716-446655440000"],
                    dynamic_generation: false,
                },
                graph: {
                    steps: [
                        {
                            id: "step_1_id",
                            name: "Find Patient",
                            description: "Search for an existing patient by first name and last name",
                            provider_id: "550e8400-e29b-41d4-a716-446655440000",
                        },
                    ],
                },
                created_at: "2024-01-15T10:30:00Z",
                updated_at: "2024-01-15T15:45:00Z",
            },
            workflow_details: {
                id: "550e8400-e29b-41d4-a716-446655440001",
                name: "Patient Data Mapping Workflow",
                workflow_instructions: "Given diagnosis data, find the patient and create condition record",
                sample_data: {
                    diagnosis_code: "I10",
                    diagnosis_date: "2025-01-01",
                    patient_first_name: "Clay",
                    patient_last_name: "Rippin",
                },
                config: {
                    fhir_provider_ids: ["550e8400-e29b-41d4-a716-446655440000"],
                    dynamic_generation: false,
                },
                graph: {
                    steps: [
                        {
                            id: "1",
                            name: "Create Patient Resource",
                            description: "Create a FHIR Patient resource from input data",
                            provider_id: "550e8400-e29b-41d4-a716-446655440000",
                            dependencies: ["dependencies"],
                            dynamic_generation: false,
                        },
                    ],
                },
                created_at: "2024-01-15T10:30:00Z",
                updated_at: "2024-01-15T15:45:00Z",
            },
        });
    });

    test("get (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new phenomlClient({ token: "test", environment: server.baseUrl });

        const rawResponseBody = { key: "value" };
        server.mockEndpoint().get("/workflows/id").respondWith().statusCode(401).jsonBody(rawResponseBody).build();

        await expect(async () => {
            return await client.workflows.get("id");
        }).rejects.toThrow(phenoml.workflows.UnauthorizedError);
    });

    test("get (3)", async () => {
        const server = mockServerPool.createServer();
        const client = new phenomlClient({ token: "test", environment: server.baseUrl });

        const rawResponseBody = { key: "value" };
        server.mockEndpoint().get("/workflows/id").respondWith().statusCode(403).jsonBody(rawResponseBody).build();

        await expect(async () => {
            return await client.workflows.get("id");
        }).rejects.toThrow(phenoml.workflows.ForbiddenError);
    });

    test("get (4)", async () => {
        const server = mockServerPool.createServer();
        const client = new phenomlClient({ token: "test", environment: server.baseUrl });

        const rawResponseBody = { key: "value" };
        server.mockEndpoint().get("/workflows/id").respondWith().statusCode(404).jsonBody(rawResponseBody).build();

        await expect(async () => {
            return await client.workflows.get("id");
        }).rejects.toThrow(phenoml.workflows.NotFoundError);
    });

    test("get (5)", async () => {
        const server = mockServerPool.createServer();
        const client = new phenomlClient({ token: "test", environment: server.baseUrl });

        const rawResponseBody = { key: "value" };
        server.mockEndpoint().get("/workflows/id").respondWith().statusCode(500).jsonBody(rawResponseBody).build();

        await expect(async () => {
            return await client.workflows.get("id");
        }).rejects.toThrow(phenoml.workflows.InternalServerError);
    });

    test("update (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new phenomlClient({ token: "test", environment: server.baseUrl });
        const rawRequestBody = {
            name: "Updated Patient Data Mapping Workflow",
            workflow_instructions: "Given diagnosis data, find the patient and create condition record",
            sample_data: { patient_last_name: "Smith", patient_first_name: "John", diagnosis_code: "E11" },
            fhir_provider_id: "550e8400-e29b-41d4-a716-446655440000",
        };
        const rawResponseBody = {
            success: true,
            message: "Workflow updated successfully",
            workflow: {
                id: "550e8400-e29b-41d4-a716-446655440001",
                name: "Patient Data Mapping Workflow",
                workflow_instructions: "Given diagnosis data, find the patient and create condition record",
                sample_data: {
                    diagnosis_code: "I10",
                    diagnosis_date: "2025-01-01",
                    patient_first_name: "Clay",
                    patient_last_name: "Rippin",
                },
                config: { fhir_provider_ids: ["550e8400-e29b-41d4-a716-446655440000"], dynamic_generation: false },
                graph: {
                    steps: [
                        {
                            id: "step_1_id",
                            name: "Find Patient",
                            description: "Search for an existing patient by first name and last name",
                            provider_id: "550e8400-e29b-41d4-a716-446655440000",
                        },
                    ],
                },
                created_at: "2024-01-15T10:30:00Z",
                updated_at: "2024-01-15T15:45:00Z",
            },
            workflow_details: {
                id: "550e8400-e29b-41d4-a716-446655440001",
                name: "Patient Data Mapping Workflow",
                workflow_instructions: "Given diagnosis data, find the patient and create condition record",
                sample_data: {
                    diagnosis_code: "I10",
                    diagnosis_date: "2025-01-01",
                    patient_first_name: "Clay",
                    patient_last_name: "Rippin",
                },
                config: { fhir_provider_ids: ["550e8400-e29b-41d4-a716-446655440000"], dynamic_generation: false },
                graph: {
                    steps: [
                        {
                            id: "1",
                            name: "Create Patient Resource",
                            description: "Create a FHIR Patient resource from input data",
                            provider_id: "550e8400-e29b-41d4-a716-446655440000",
                            dependencies: ["dependencies"],
                            dynamic_generation: false,
                        },
                    ],
                },
                created_at: "2024-01-15T10:30:00Z",
                updated_at: "2024-01-15T15:45:00Z",
            },
        };
        server
            .mockEndpoint()
            .put("/workflows/id")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.workflows.update("id", {
            verbose: true,
            name: "Updated Patient Data Mapping Workflow",
            workflow_instructions: "Given diagnosis data, find the patient and create condition record",
            sample_data: {
                patient_last_name: "Smith",
                patient_first_name: "John",
                diagnosis_code: "E11",
            },
            fhir_provider_id: "550e8400-e29b-41d4-a716-446655440000",
        });
        expect(response).toEqual({
            success: true,
            message: "Workflow updated successfully",
            workflow: {
                id: "550e8400-e29b-41d4-a716-446655440001",
                name: "Patient Data Mapping Workflow",
                workflow_instructions: "Given diagnosis data, find the patient and create condition record",
                sample_data: {
                    diagnosis_code: "I10",
                    diagnosis_date: "2025-01-01",
                    patient_first_name: "Clay",
                    patient_last_name: "Rippin",
                },
                config: {
                    fhir_provider_ids: ["550e8400-e29b-41d4-a716-446655440000"],
                    dynamic_generation: false,
                },
                graph: {
                    steps: [
                        {
                            id: "step_1_id",
                            name: "Find Patient",
                            description: "Search for an existing patient by first name and last name",
                            provider_id: "550e8400-e29b-41d4-a716-446655440000",
                        },
                    ],
                },
                created_at: "2024-01-15T10:30:00Z",
                updated_at: "2024-01-15T15:45:00Z",
            },
            workflow_details: {
                id: "550e8400-e29b-41d4-a716-446655440001",
                name: "Patient Data Mapping Workflow",
                workflow_instructions: "Given diagnosis data, find the patient and create condition record",
                sample_data: {
                    diagnosis_code: "I10",
                    diagnosis_date: "2025-01-01",
                    patient_first_name: "Clay",
                    patient_last_name: "Rippin",
                },
                config: {
                    fhir_provider_ids: ["550e8400-e29b-41d4-a716-446655440000"],
                    dynamic_generation: false,
                },
                graph: {
                    steps: [
                        {
                            id: "1",
                            name: "Create Patient Resource",
                            description: "Create a FHIR Patient resource from input data",
                            provider_id: "550e8400-e29b-41d4-a716-446655440000",
                            dependencies: ["dependencies"],
                            dynamic_generation: false,
                        },
                    ],
                },
                created_at: "2024-01-15T10:30:00Z",
                updated_at: "2024-01-15T15:45:00Z",
            },
        });
    });

    test("update (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new phenomlClient({ token: "test", environment: server.baseUrl });
        const rawRequestBody = {
            name: "name",
            workflow_instructions: "workflow_instructions",
            sample_data: { sample_data: { key: "value" } },
            fhir_provider_id: "fhir_provider_id",
        };
        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .put("/workflows/id")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(400)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.workflows.update("id", {
                name: "name",
                workflow_instructions: "workflow_instructions",
                sample_data: {
                    sample_data: {
                        key: "value",
                    },
                },
                fhir_provider_id: "fhir_provider_id",
            });
        }).rejects.toThrow(phenoml.workflows.BadRequestError);
    });

    test("update (3)", async () => {
        const server = mockServerPool.createServer();
        const client = new phenomlClient({ token: "test", environment: server.baseUrl });
        const rawRequestBody = {
            name: "name",
            workflow_instructions: "workflow_instructions",
            sample_data: { sample_data: { key: "value" } },
            fhir_provider_id: "fhir_provider_id",
        };
        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .put("/workflows/id")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(401)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.workflows.update("id", {
                name: "name",
                workflow_instructions: "workflow_instructions",
                sample_data: {
                    sample_data: {
                        key: "value",
                    },
                },
                fhir_provider_id: "fhir_provider_id",
            });
        }).rejects.toThrow(phenoml.workflows.UnauthorizedError);
    });

    test("update (4)", async () => {
        const server = mockServerPool.createServer();
        const client = new phenomlClient({ token: "test", environment: server.baseUrl });
        const rawRequestBody = {
            name: "name",
            workflow_instructions: "workflow_instructions",
            sample_data: { sample_data: { key: "value" } },
            fhir_provider_id: "fhir_provider_id",
        };
        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .put("/workflows/id")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(403)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.workflows.update("id", {
                name: "name",
                workflow_instructions: "workflow_instructions",
                sample_data: {
                    sample_data: {
                        key: "value",
                    },
                },
                fhir_provider_id: "fhir_provider_id",
            });
        }).rejects.toThrow(phenoml.workflows.ForbiddenError);
    });

    test("update (5)", async () => {
        const server = mockServerPool.createServer();
        const client = new phenomlClient({ token: "test", environment: server.baseUrl });
        const rawRequestBody = {
            name: "name",
            workflow_instructions: "workflow_instructions",
            sample_data: { sample_data: { key: "value" } },
            fhir_provider_id: "fhir_provider_id",
        };
        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .put("/workflows/id")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(404)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.workflows.update("id", {
                name: "name",
                workflow_instructions: "workflow_instructions",
                sample_data: {
                    sample_data: {
                        key: "value",
                    },
                },
                fhir_provider_id: "fhir_provider_id",
            });
        }).rejects.toThrow(phenoml.workflows.NotFoundError);
    });

    test("update (6)", async () => {
        const server = mockServerPool.createServer();
        const client = new phenomlClient({ token: "test", environment: server.baseUrl });
        const rawRequestBody = {
            name: "name",
            workflow_instructions: "workflow_instructions",
            sample_data: { sample_data: { key: "value" } },
            fhir_provider_id: "fhir_provider_id",
        };
        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .put("/workflows/id")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(500)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.workflows.update("id", {
                name: "name",
                workflow_instructions: "workflow_instructions",
                sample_data: {
                    sample_data: {
                        key: "value",
                    },
                },
                fhir_provider_id: "fhir_provider_id",
            });
        }).rejects.toThrow(phenoml.workflows.InternalServerError);
    });

    test("delete (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new phenomlClient({ token: "test", environment: server.baseUrl });

        const rawResponseBody = { success: true, message: "Workflow deleted successfully" };
        server.mockEndpoint().delete("/workflows/id").respondWith().statusCode(200).jsonBody(rawResponseBody).build();

        const response = await client.workflows.delete("id");
        expect(response).toEqual({
            success: true,
            message: "Workflow deleted successfully",
        });
    });

    test("delete (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new phenomlClient({ token: "test", environment: server.baseUrl });

        const rawResponseBody = { key: "value" };
        server.mockEndpoint().delete("/workflows/id").respondWith().statusCode(401).jsonBody(rawResponseBody).build();

        await expect(async () => {
            return await client.workflows.delete("id");
        }).rejects.toThrow(phenoml.workflows.UnauthorizedError);
    });

    test("delete (3)", async () => {
        const server = mockServerPool.createServer();
        const client = new phenomlClient({ token: "test", environment: server.baseUrl });

        const rawResponseBody = { key: "value" };
        server.mockEndpoint().delete("/workflows/id").respondWith().statusCode(403).jsonBody(rawResponseBody).build();

        await expect(async () => {
            return await client.workflows.delete("id");
        }).rejects.toThrow(phenoml.workflows.ForbiddenError);
    });

    test("delete (4)", async () => {
        const server = mockServerPool.createServer();
        const client = new phenomlClient({ token: "test", environment: server.baseUrl });

        const rawResponseBody = { key: "value" };
        server.mockEndpoint().delete("/workflows/id").respondWith().statusCode(404).jsonBody(rawResponseBody).build();

        await expect(async () => {
            return await client.workflows.delete("id");
        }).rejects.toThrow(phenoml.workflows.NotFoundError);
    });

    test("delete (5)", async () => {
        const server = mockServerPool.createServer();
        const client = new phenomlClient({ token: "test", environment: server.baseUrl });

        const rawResponseBody = { key: "value" };
        server.mockEndpoint().delete("/workflows/id").respondWith().statusCode(500).jsonBody(rawResponseBody).build();

        await expect(async () => {
            return await client.workflows.delete("id");
        }).rejects.toThrow(phenoml.workflows.InternalServerError);
    });

    test("execute (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new phenomlClient({ token: "test", environment: server.baseUrl });
        const rawRequestBody = {
            input_data: {
                patient_last_name: "Johnson",
                patient_first_name: "Mary",
                diagnosis_code: "M79.3",
                encounter_date: "2024-01-15",
            },
        };
        const rawResponseBody = {
            success: true,
            message: "Workflow executed successfully",
            results: { steps: { key: "value" } },
        };
        server
            .mockEndpoint()
            .post("/workflows/id/execute")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.workflows.execute("id", {
            input_data: {
                patient_last_name: "Johnson",
                patient_first_name: "Mary",
                diagnosis_code: "M79.3",
                encounter_date: "2024-01-15",
            },
        });
        expect(response).toEqual({
            success: true,
            message: "Workflow executed successfully",
            results: {
                steps: {
                    key: "value",
                },
            },
        });
    });

    test("execute (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new phenomlClient({ token: "test", environment: server.baseUrl });
        const rawRequestBody = { input_data: { input_data: { key: "value" } } };
        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .post("/workflows/id/execute")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(400)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.workflows.execute("id", {
                input_data: {
                    input_data: {
                        key: "value",
                    },
                },
            });
        }).rejects.toThrow(phenoml.workflows.BadRequestError);
    });

    test("execute (3)", async () => {
        const server = mockServerPool.createServer();
        const client = new phenomlClient({ token: "test", environment: server.baseUrl });
        const rawRequestBody = { input_data: { input_data: { key: "value" } } };
        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .post("/workflows/id/execute")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(401)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.workflows.execute("id", {
                input_data: {
                    input_data: {
                        key: "value",
                    },
                },
            });
        }).rejects.toThrow(phenoml.workflows.UnauthorizedError);
    });

    test("execute (4)", async () => {
        const server = mockServerPool.createServer();
        const client = new phenomlClient({ token: "test", environment: server.baseUrl });
        const rawRequestBody = { input_data: { input_data: { key: "value" } } };
        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .post("/workflows/id/execute")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(403)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.workflows.execute("id", {
                input_data: {
                    input_data: {
                        key: "value",
                    },
                },
            });
        }).rejects.toThrow(phenoml.workflows.ForbiddenError);
    });

    test("execute (5)", async () => {
        const server = mockServerPool.createServer();
        const client = new phenomlClient({ token: "test", environment: server.baseUrl });
        const rawRequestBody = { input_data: { input_data: { key: "value" } } };
        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .post("/workflows/id/execute")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(404)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.workflows.execute("id", {
                input_data: {
                    input_data: {
                        key: "value",
                    },
                },
            });
        }).rejects.toThrow(phenoml.workflows.NotFoundError);
    });

    test("execute (6)", async () => {
        const server = mockServerPool.createServer();
        const client = new phenomlClient({ token: "test", environment: server.baseUrl });
        const rawRequestBody = { input_data: { input_data: { key: "value" } } };
        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .post("/workflows/id/execute")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(500)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.workflows.execute("id", {
                input_data: {
                    input_data: {
                        key: "value",
                    },
                },
            });
        }).rejects.toThrow(phenoml.workflows.InternalServerError);
    });
});
