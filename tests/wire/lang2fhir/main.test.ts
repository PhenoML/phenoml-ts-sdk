// This file was auto-generated by Fern from our API Definition.

import * as phenoml from "../../../src/api/index";
import { phenomlClient } from "../../../src/Client";
import { mockServerPool } from "../../mock-server/MockServerPool";

describe("Lang2Fhir", () => {
    test("create (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new phenomlClient({ token: "test", environment: server.baseUrl });
        const rawRequestBody = {
            version: "R4",
            resource: "auto",
            text: "Patient has severe asthma with acute exacerbation",
        };
        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .post("/lang2fhir/create")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.lang2Fhir.create({
            version: "R4",
            resource: "auto",
            text: "Patient has severe asthma with acute exacerbation",
        });
        expect(response).toEqual({
            key: "value",
        });
    });

    test("create (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new phenomlClient({ token: "test", environment: server.baseUrl });
        const rawRequestBody = { version: "R4", resource: "auto", text: "text" };
        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .post("/lang2fhir/create")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(400)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.lang2Fhir.create({
                version: "R4",
                resource: "auto",
                text: "text",
            });
        }).rejects.toThrow(phenoml.lang2Fhir.BadRequestError);
    });

    test("create (3)", async () => {
        const server = mockServerPool.createServer();
        const client = new phenomlClient({ token: "test", environment: server.baseUrl });
        const rawRequestBody = { version: "R4", resource: "auto", text: "text" };
        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .post("/lang2fhir/create")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(401)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.lang2Fhir.create({
                version: "R4",
                resource: "auto",
                text: "text",
            });
        }).rejects.toThrow(phenoml.lang2Fhir.UnauthorizedError);
    });

    test("create (4)", async () => {
        const server = mockServerPool.createServer();
        const client = new phenomlClient({ token: "test", environment: server.baseUrl });
        const rawRequestBody = { version: "R4", resource: "auto", text: "text" };
        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .post("/lang2fhir/create")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(500)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.lang2Fhir.create({
                version: "R4",
                resource: "auto",
                text: "text",
            });
        }).rejects.toThrow(phenoml.lang2Fhir.InternalServerError);
    });

    test("search (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new phenomlClient({ token: "test", environment: server.baseUrl });
        const rawRequestBody = { text: "Appointments between March 2-9, 2025" };
        const rawResponseBody = { resourceType: "Appointment", searchParams: "date=ge2025-03-02&date=le2025-03-09" };
        server
            .mockEndpoint()
            .post("/lang2fhir/search")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.lang2Fhir.search({
            text: "Appointments between March 2-9, 2025",
        });
        expect(response).toEqual({
            resourceType: "Appointment",
            searchParams: "date=ge2025-03-02&date=le2025-03-09",
        });
    });

    test("search (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new phenomlClient({ token: "test", environment: server.baseUrl });
        const rawRequestBody = { text: "text" };
        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .post("/lang2fhir/search")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(400)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.lang2Fhir.search({
                text: "text",
            });
        }).rejects.toThrow(phenoml.lang2Fhir.BadRequestError);
    });

    test("search (3)", async () => {
        const server = mockServerPool.createServer();
        const client = new phenomlClient({ token: "test", environment: server.baseUrl });
        const rawRequestBody = { text: "text" };
        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .post("/lang2fhir/search")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(401)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.lang2Fhir.search({
                text: "text",
            });
        }).rejects.toThrow(phenoml.lang2Fhir.UnauthorizedError);
    });

    test("search (4)", async () => {
        const server = mockServerPool.createServer();
        const client = new phenomlClient({ token: "test", environment: server.baseUrl });
        const rawRequestBody = { text: "text" };
        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .post("/lang2fhir/search")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(424)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.lang2Fhir.search({
                text: "text",
            });
        }).rejects.toThrow(phenoml.lang2Fhir.FailedDependencyError);
    });

    test("search (5)", async () => {
        const server = mockServerPool.createServer();
        const client = new phenomlClient({ token: "test", environment: server.baseUrl });
        const rawRequestBody = { text: "text" };
        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .post("/lang2fhir/search")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(500)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.lang2Fhir.search({
                text: "text",
            });
        }).rejects.toThrow(phenoml.lang2Fhir.InternalServerError);
    });

    test("uploadProfile (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new phenomlClient({ token: "test", environment: server.baseUrl });
        const rawRequestBody = {
            version: "R4",
            resource: "condition-encounter-diagnosis",
            profile: "(base64 encoded JSON string of the FHIR profile)",
        };
        const rawResponseBody = {
            message: "Profile uploaded successfully",
            id: "0ofoiy2o7a3pvwj",
            resource: "custom-patient",
            version: "4.0.1",
            url: "http://phenoml.com/fhir/StructureDefinition/custom-patient",
        };
        server
            .mockEndpoint()
            .post("/lang2fhir/profile/upload")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.lang2Fhir.uploadProfile({
            version: "R4",
            resource: "condition-encounter-diagnosis",
            profile: "(base64 encoded JSON string of the FHIR profile)",
        });
        expect(response).toEqual({
            message: "Profile uploaded successfully",
            id: "0ofoiy2o7a3pvwj",
            resource: "custom-patient",
            version: "4.0.1",
            url: "http://phenoml.com/fhir/StructureDefinition/custom-patient",
        });
    });

    test("uploadProfile (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new phenomlClient({ token: "test", environment: server.baseUrl });
        const rawRequestBody = { version: "version", resource: "resource", profile: "profile" };
        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .post("/lang2fhir/profile/upload")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(400)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.lang2Fhir.uploadProfile({
                version: "version",
                resource: "resource",
                profile: "profile",
            });
        }).rejects.toThrow(phenoml.lang2Fhir.BadRequestError);
    });

    test("uploadProfile (3)", async () => {
        const server = mockServerPool.createServer();
        const client = new phenomlClient({ token: "test", environment: server.baseUrl });
        const rawRequestBody = { version: "version", resource: "resource", profile: "profile" };
        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .post("/lang2fhir/profile/upload")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(401)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.lang2Fhir.uploadProfile({
                version: "version",
                resource: "resource",
                profile: "profile",
            });
        }).rejects.toThrow(phenoml.lang2Fhir.UnauthorizedError);
    });

    test("uploadProfile (4)", async () => {
        const server = mockServerPool.createServer();
        const client = new phenomlClient({ token: "test", environment: server.baseUrl });
        const rawRequestBody = { version: "version", resource: "resource", profile: "profile" };
        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .post("/lang2fhir/profile/upload")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(403)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.lang2Fhir.uploadProfile({
                version: "version",
                resource: "resource",
                profile: "profile",
            });
        }).rejects.toThrow(phenoml.lang2Fhir.ForbiddenError);
    });

    test("uploadProfile (5)", async () => {
        const server = mockServerPool.createServer();
        const client = new phenomlClient({ token: "test", environment: server.baseUrl });
        const rawRequestBody = { version: "version", resource: "resource", profile: "profile" };
        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .post("/lang2fhir/profile/upload")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(500)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.lang2Fhir.uploadProfile({
                version: "version",
                resource: "resource",
                profile: "profile",
            });
        }).rejects.toThrow(phenoml.lang2Fhir.InternalServerError);
    });

    test("document (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new phenomlClient({ token: "test", environment: server.baseUrl });
        const rawRequestBody = {
            version: "R4",
            resource: "questionnaire",
            content: "content",
            fileType: "application/pdf",
        };
        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .post("/lang2fhir/document")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.lang2Fhir.document({
            version: "R4",
            resource: "questionnaire",
            content: "content",
            fileType: "application/pdf",
        });
        expect(response).toEqual({
            key: "value",
        });
    });

    test("document (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new phenomlClient({ token: "test", environment: server.baseUrl });
        const rawRequestBody = {
            version: "version",
            resource: "questionnaire",
            content: "content",
            fileType: "application/pdf",
        };
        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .post("/lang2fhir/document")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(400)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.lang2Fhir.document({
                version: "version",
                resource: "questionnaire",
                content: "content",
                fileType: "application/pdf",
            });
        }).rejects.toThrow(phenoml.lang2Fhir.BadRequestError);
    });

    test("document (3)", async () => {
        const server = mockServerPool.createServer();
        const client = new phenomlClient({ token: "test", environment: server.baseUrl });
        const rawRequestBody = {
            version: "version",
            resource: "questionnaire",
            content: "content",
            fileType: "application/pdf",
        };
        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .post("/lang2fhir/document")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(401)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.lang2Fhir.document({
                version: "version",
                resource: "questionnaire",
                content: "content",
                fileType: "application/pdf",
            });
        }).rejects.toThrow(phenoml.lang2Fhir.UnauthorizedError);
    });

    test("document (4)", async () => {
        const server = mockServerPool.createServer();
        const client = new phenomlClient({ token: "test", environment: server.baseUrl });
        const rawRequestBody = {
            version: "version",
            resource: "questionnaire",
            content: "content",
            fileType: "application/pdf",
        };
        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .post("/lang2fhir/document")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(500)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.lang2Fhir.document({
                version: "version",
                resource: "questionnaire",
                content: "content",
                fileType: "application/pdf",
            });
        }).rejects.toThrow(phenoml.lang2Fhir.InternalServerError);
    });
});
